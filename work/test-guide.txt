# Manual Test Guide for Interactive Exercise Module

This guide provides instructions for testing the first interactive exercise page (`L1 - congiuntivoES.html`) that was converted to the new, universal template system.

**Objective:** To verify that all core features—interaction, state management, notes, and feedback—are working correctly through the new `exercise-handler.js` module.

---

### Part 1: Loading the Exercise

1.  **Start the Application:** Launch the application.
2.  **Navigate to the Exercise:** In the application's navigation pane (on the left), find and click on the item for `L1 - congiuntivoES.html` under the "Exercises" section.
3.  **Initial Verification:**
    *   **[PASS/FAIL]** The page loads without any visible errors. > Pass
    *   **[PASS/FAIL]** The main content area shows a question, navigation buttons ("Previous", "Next"), and a "Check Answer" button. > If by check answer you mean True/False then Pass
    *   **[PASS/FAIL]** A "Jump to..." dropdown menu is visible, populated with question numbers. > Pass

---

### Part 2: Answering Questions and Feedback

1.  **Answer the First Question:** Interact with the first question presented. Answer it correctly.
2.  **Check Answer:** Click the "Check Answer" button.
    *   **[PASS/FAIL]** A feedback area should appear, indicating that the answer is correct. > Pass
    *   **[PASS/FAIL]** An explanation for the answer should be displayed. > Pass
    *   **[PASS/FAIL]** The input for the question should now be disabled. > Pass
3.  **Proceed to Next Question:** Click the "Next" button.
4.  **Answer Incorrectly:** Intentionally provide an incorrect answer to the second question.
5.  **Check Answer:** Click the "Check Answer" button.
    *   **[PASS/FAIL]** The feedback area should indicate that the answer is incorrect. > Pass
    *   **[PASS/FAIL]** The correct answer and an explanation should be displayed. > Pass
6.  **Navigate with "Jump to":** Use the "Jump to..." dropdown to navigate to a question further down the list (e.g., Question 5).
    *   **[PASS/FAIL]** The view updates to show Question 5. > Pass


---

### Part 3: State Management (Save & Load)

1.  **Answer Several Questions:** Proceed through the exercise and answer 3-4 questions. Leave some unanswered.
2.  **Save Progress:** Click the global "Save" button in the application's main toolbar.
3.  **Reload the Page:**
    *   Navigate to a different page (e.g., the "Home" screen).
    *   Navigate back to the `L1 - congiuntivoES.html` exercise.
4.  **Initial State After Reload:**
    *   **[PASS/FAIL]** The page should load in the same state as when you left it. The answers you provided should still be there, and the feedback for checked questions should be visible. > Fail, save state doesn't seem to work as intended
5.  **Load Progress Manually:** Click the global "Load" button in the main toolbar.
    *   **[PASS/FAIL]** The page should reload and explicitly restore your saved progress, confirming the manual load works. Your previously answered questions (from step 1 of this section) should be visible. > FAIL

---

### Part 4: Notes Component

1.  **Open Page Notes:** Find the "Notes" button or icon for the overall page. Click it.
2.  **Add a Page Note:** A textarea should appear. Type a test note, for example: "This is a page-level note for the congiuntivo exercise."
3.  **Save and Reload:** Click "Save". Navigate away from the page and then back to it.
    *   **[PASS/FAIL]** The note you wrote should still be present in the notes area. > FAIL - save button doesn't work
4.  **Open Question Notes:** Navigate to a specific question (e.g., Question 3). Find the "Show Note" or similar button for that individual question.
5.  **Add a Question Note:** A textarea should appear. Type a test note, for example: "Note for question 3."
6.  **Save and Reload:** Click "Save". Navigate away and back again. Go to Question 3.
    *   **[PASS/FAIL]** The note specific to Question 3 should be present. > FAIL - save button doesn't work
    *   **[PASS/FAIL]** The general page note from step 2 should also still be present. > FAIL - save button doesn't work

---

### Part 5: Final Scoreboard > Not attempted

1.  **Complete All Questions:** Answer all remaining questions in the exercise.
2.  **Check Final Screen:** After the last question is answered and checked, a final scoreboard or results summary should be displayed.
    *   **[PASS/FAIL]** The scoreboard correctly shows the number of correct and incorrect answers.
    *   **[PASS/FAIL]** The scoreboard provides an option to review the answers.

If all the above points pass, the integration of the interactive exercise module is considered successful.

---

User notes, on opening the page this is the log:
Found module "interactive-exercise", delegating to handler.
exercise-handler.js:462 Initializing generic interactive exercise...
exercise-handler.js:473 Exercise data loaded: {title: 'Esercizi Pratici: Il Congiuntivo', subtitle: 'Metti in pratica la teoria con esercizi mirati.', fase1: Array(50), fase2: Array(30), fase3: Array(20)}
exercise-handler.js:479 Old 'fase' format detected. Converting to generic format for compatibility.
handleInteractiveExercise @ exercise-handler.js:479
hydrateContent @ content-hydrator.js:43
loadContentIntoTab @ content-loader.js:39
await in loadContentIntoTab (async)
eval @ content-loader.js:258
exercise-handler.js:492 Data converted to new format with inferred types: (100) [{…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}]
exercise-handler.js:42 Initialized new generic exercise state: {currentQuestionIndex: 0, answers: Array(100), exerciseNote: ''}
exercise-handler.js:51 Render triggered. Current state: {currentQuestionIndex: 0, answers: Array(100), exerciseNote: ''}
exercise-handler.js:294 Stub: createNavigation

the multi-block format of the excercises html is.. lost?
There's only one page with 100 excercises, that is plain wrong.
i separated L1 - congiuntivoES.html (old version) from a new L1 - congiuntivoES-RE.html to keep both versions until certain issues are resolved.
From now on work on L1 - congiuntivoES-RE.html until all issues are resolved.

User notes from part 2 of the tests:
The 'Mark as correct' appears and works correctly.
The previously implemented 'Back to N1' to return to first question is absent 

User notes from part 3 of the test:
Save state doesn't seem to work. Page doesn't lose progress on tab change, but on closing tab and reopening page has reset.
Save state for L1 ES doesn't show under Active Auto-Saves in settings page
Save/Load/Reset buttons don't seem to work.

From console, when clicking buttons
renderer.js:111 Could not find pageId to reset.
globalResetBtn.onclick @ renderer.js:111
renderer.js:319 Could not find pageId to load state into.
handleLoadButtonClick @ renderer.js:319
globalLoadBtn.onclick @ renderer.js:107
renderer.js:270 No active exercise tab, pageId, or state to save.

User notes from part 4 of the test:
Notes area are displayed as before
They appear correctly, can be written correctly, but are impacted by the same issues as part 3
Generally it seems like you lost the distinction between save-states and saves 

---

be careful to not break the excercise blocks logic
be careful to not break the 'visuals' of the current excercise page 
visually the ONLY thing missing is the 'Go back to N1 button' which was lost somewhere along the way during our refactoring

---

user notes:
go back to N1 is now in the right place
the three phases are now once more in place

1) reset blocco shouldn't have the popup asking if you are sure > FIXED
2) reset blocco doesn't reset the notes for the whole blocco/fase > FIXED
3) change blocco with fase > FIXED
4) the reset in the toolbar does nothing at all 
5) save and load still don't work correctly
6) save states still don't work correctly

in console i see
exercise-handler.js:573 Old 'fase' format detected. Converting to new block format.

in console i still see
exercise-handler.js:575 Old 'fase' format detected. Converting to new fase-based format.

user notes 2:

these persist
4) the 'Azzera' in the toolbar does nothing at all, it should reset all 'fase' blocks. its purpose is to always clean all saves for a page. > FIXED
5) save and load still don't work correctly > FIXED
6) save states still don't work correctly > FIXED


in console i still see
exercise-handler.js:575 Old 'fase' format detected. Converting to new fase-based format.
save state and save/load and reset still don't work correctly


after Final State Management Fix (The Actual Final One)
all issues seem resolved
the only problem (?) is
exercise-handler.js:575 Old 'fase' format detected. Converting to new fase-based format.

in the console.
is this an issue? it seems to at least indicate some lack of stability

---

# Test Guide for Converted L2 and L3 Exercises

**Objective:** To verify that the newly converted exercise pages (`L2 - causativoES.html` and `L3 - passivo avanzatoES.html`) function correctly using the universal `exercise-handler.js`.

**Instructions:** Please perform the following tests for **BOTH** `L2 - causativoES.html` and `L3 - passivo avanzatoES.html`.

---

### 1. Loading and Basic Interaction

1.  **Navigate to the Exercise:** Open the application and click on the exercise link in the left-hand navigation pane.
2.  **Verify Initial Load:**
    *   **[PASS/FAIL]** The page loads correctly without errors.
    *   **[PASS/FAIL]** The title and subtitle match the exercise content.
    *   **[PASS/FAIL]** The view shows a tabbed interface for "Fase 1", "Fase 2", and "Fase 3".
    *   **[PASS/FAIL]** "Fase 1" is active by default, showing the first question.

### 2. Answering and Block Navigation

1.  **Answer a Question:** Answer the first question in "Fase 1".
2.  **Check Feedback:** Verify that correct/incorrect feedback is displayed as expected.
3.  **Navigate Blocks:**
    *   Click on the "Fase 2" tab.
    *   **[PASS/FAIL]** The view switches to the first question of "Fase 2".
    *   Answer a question in "Fase 2" and verify feedback.
    *   Click on the "Fase 3" tab and do the same.
4.  **Return to Previous Block:**
    *   Click back on the "Fase 1" tab.
    *   **[PASS/FAIL]** Your previous answer and feedback from step 2 should still be visible.

### 3. State Management (Save, Load, Reset)

1.  **Set State:** Answer a few questions across different "Fase" tabs but do not complete the exercise.
2.  **Save State:** Click the global "Save" button in the toolbar.
3.  **Reload Tab:** Close the exercise tab and reopen it from the navigation pane.
4.  **Verify Auto-Load:**
    *   **[PASS/FAIL]** The exercise should load with all your previous answers and feedback intact.
5.  **Test Global Reset:**
    *   Click the global "Azzera" (Reset) button in the toolbar.
    *   **[PASS/FAIL]** The exercise should completely reset, clearing all answers and feedback across all "Fase" tabs.
6.  **Test Manual Load:**
    *   Close and reopen the tab again.
    *   Answer one question.
    *   Click the global "Load" button.
    *   **[PASS/FAIL]** The exercise should revert to the state you saved in step 2, overwriting your most recent answer.

### 4. Notes Functionality

1.  **Test Block Notes:**
    *   In any "Fase" tab, write a note in the "I tuoi appunti per questa fase" textarea.
    *   Switch to a different "Fase" tab and then back.
    *   **[PASS/FAIL]** The note should still be there.
2.  **Test State Persistence:**
    *   With a note written, click the global "Save" button.
    *   Close and reopen the tab.
    *   **[PASS/FAIL]** The note you wrote should be loaded along with your answers.
